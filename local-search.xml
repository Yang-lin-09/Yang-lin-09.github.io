<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Archlinux restore from timeshift backup</title>
    <link href="/2021/07/14/Archlinux-restore-from-timeshift-backup/"/>
    <url>/2021/07/14/Archlinux-restore-from-timeshift-backup/</url>
    
    <content type="html"><![CDATA[<h3 id="准备一个U盘"><a href="#准备一个U盘" class="headerlink" title="准备一个U盘"></a>准备一个U盘</h3><p>首先需要准备一个archlinux的启动U盘，然后在BIOS界面进入U盘的archlinux系统。</p><h3 id="挂载分区"><a href="#挂载分区" class="headerlink" title="挂载分区"></a>挂载分区</h3>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>timeshift</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Archlinux shuts down slowly</title>
    <link href="/2021/07/04/Archlinux-shuts-down-slowly/"/>
    <url>/2021/07/04/Archlinux-shuts-down-slowly/</url>
    
    <content type="html"><![CDATA[<h3 id="archlinux关机缓慢"><a href="#archlinux关机缓慢" class="headerlink" title="archlinux关机缓慢"></a>archlinux关机缓慢</h3><p>Archlinux在关机的时候，经常会等很久，且屏幕上显示<code>A stop job is running for Session c1 of user **</code>，这是由于systemd无法终止某些服务的问题造成的。</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>编辑<code>/etc/systemd/system.conf</code>文件，将</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#DefaultTimeoutStopSec=90s</span><br></code></pre></td></tr></table></figure><p>改为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">DefaultTimeoutStopSec=10s<br></code></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ol><li><a href="https://blog.fevenor.com/2016/04/15/archlinux-long-time-to-shutdown/">https://blog.fevenor.com/2016/04/15/archlinux-long-time-to-shutdown/</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>system</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Activate Windows 10</title>
    <link href="/2021/06/17/Activate-Windows-10/"/>
    <url>/2021/06/17/Activate-Windows-10/</url>
    
    <content type="html"><![CDATA[<h3 id="激活Windows10或者11"><a href="#激活Windows10或者11" class="headerlink" title="激活Windows10或者11"></a>激活Windows10或者11</h3><p>以管理员权限运行CMD，依次执行以下命令。</p><p>清除原先的密钥管理工具：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">slmgr /ckms<br></code></pre></td></tr></table></figure><p>使用密钥，这个密钥是Windows10 Pro的，需要别的版本可以自行替换：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX<br></code></pre></td></tr></table></figure><p>与KMS服务器保持连接，失效的话，可以自行搜索密钥服务管理器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">slmgr /skms kms.03k.org<br></code></pre></td></tr></table></figure><p>让Windows在线激活：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">slmgr /ato<br></code></pre></td></tr></table></figure><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ol><li><a href="https://www.youtube.com/watch?v=5loeDGnium8">https://www.youtube.com/watch?v=5loeDGnium8</a></li><li><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn502540(v=ws.11)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn502540(v=ws.11)</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>Windows10</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux and Windows grub</title>
    <link href="/2021/06/12/Linux-and-Windows-grub/"/>
    <url>/2021/06/12/Linux-and-Windows-grub/</url>
    
    <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>更新linux引导中只有linux的引导，没有Windows的引导</p><h3 id="下载os-prober"><a href="#下载os-prober" class="headerlink" title="下载os-prober"></a>下载os-prober</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo pacman -S os-prober<br></code></pre></td></tr></table></figure><p>使用grub-mkconfig的时候，os-prober可以自动识别Windows分区，并加到启动项里。如果不挂载Windows的efi分区，运行grub-mkconfig，将导致Windows的entry消失。</p><h3 id="生成新的引导文件"><a href="#生成新的引导文件" class="headerlink" title="生成新的引导文件"></a>生成新的引导文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>grub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dell inspiration7590 Microphone</title>
    <link href="/2021/06/08/Dell-inspiration7590-Microphone/"/>
    <url>/2021/06/08/Dell-inspiration7590-Microphone/</url>
    
    <content type="html"><![CDATA[<h3 id="麦克风没有出现在系统的设置里"><a href="#麦克风没有出现在系统的设置里" class="headerlink" title="麦克风没有出现在系统的设置里"></a>麦克风没有出现在系统的设置里</h3><p>使用下面的命令获得麦克风的card and device number</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ arecord -l<br><br>**** List of CAPTURE Hardware Devices ****<br>card 0: sofhdadsp [sof-hda-dsp], device 0: HDA Analog (*) []<br>  Subdevices: 1/1<br>  Subdevice <span class="hljs-comment">#0: subdevice #0</span><br></code></pre></td></tr></table></figure><p>用上面获得的数值，得到<code>hw:CARD,DEVICE</code><br>然后，编辑<code>/etc/pulse/default.pa</code>，插入<code>load-module</code>加载声卡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">load-module module-alsa-source device=hw:0,0<br><span class="hljs-comment"># the line above should be somewhere before the line below</span><br>.ifexists module-udev-detect.so<br></code></pre></td></tr></table></figure><p>最后，重启pulseaudiio应用新设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ pulseaudio -k ; pulseaudio -D<br></code></pre></td></tr></table></figure><h3 id="查看声卡驱动"><a href="#查看声卡驱动" class="headerlink" title="查看声卡驱动"></a>查看声卡驱动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ lspci -v<br><br>00:1f.3 Multimedia audio controller: Intel Corporation Cannon Lake PCH cAVS (rev 10)<br>        DeviceName: Onboard - Sound<br>        Subsystem: Dell Device 0922<br>        Flags: bus master, fast devsel, latency 32, IRQ 174, IOMMU group 15<br>        Memory at ed418000 (64-bit, non-prefetchable) [size=16K]<br>        Memory at ed100000 (64-bit, non-prefetchable) [size=1M]<br>        Capabilities: &lt;access denied&gt;<br>        Kernel driver <span class="hljs-keyword">in</span> use: sof-audio-pci-intel-cnl<br>        Kernel modules: snd_hda_intel, snd_soc_skl, snd_sof_pci_intel_cnl<br></code></pre></td></tr></table></figure><p>如果使用中的驱动是snd_hda_intel，编辑<code>/etc/modprobe.d/dsp-fix.conf</code>或者<code>/etc/modprobe.d/audio-fix.conf</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">cat dsp-fix.conf      <br><span class="hljs-comment"># options snd-intel-dspcfg dsp_driver=1</span><br></code></pre></td></tr></table></figure><p>将这一行注释掉，然后使用<code>pacman</code>安装<code>sof-firmware</code>和<code>alsa-ucm-conf</code>固件，就会启用sof-hda-dsp driver。之后可以在系统设置中看见麦克风。</p><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ol><li><a href="https://wiki.archlinux.org/title/PulseAudio/Troubleshooting#Microphone_not_detected_by_PulseAudio">https://wiki.archlinux.org/title/PulseAudio/Troubleshooting#Microphone_not_detected_by_PulseAudio</a></li><li><a href="https://wiki.archlinux.org/title/Dell_Inspiron_15_(7590)#Use_the_new_sof-hda-dsp_driver">https://wiki.archlinux.org/title/Dell_Inspiron_15_(7590)#Use_the_new_sof-hda-dsp_driver</a></li><li><a href="https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture#ALSA_firmware">https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture#ALSA_firmware</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
